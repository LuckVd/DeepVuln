rules:
  - id: java.sql-injection.jdbc-execute
    patterns:
      - pattern-either:
          - pattern: |
              $STMT = $CONN.createStatement(...);
              ...
              $STMT.executeQuery($QUERY);
          - pattern: $STMT.executeQuery($QUERY + ...)
          - pattern: $STMT.executeUpdate($QUERY + ...)
          - pattern: $STMT.execute($QUERY + ...)
      - pattern-not: $STMT.executeQuery("...")
      - pattern-not: $STMT.executeUpdate("...")
    message: "Potential SQL injection - dynamic string concatenation in SQL query"
    severity: ERROR
    languages: [java]
    metadata:
      category: security
      cwe: "CWE-89"
      owasp: "A03:2021 - Injection"
      confidence: HIGH
      references:
        - https://cwe.mitre.org/data/definitions/89.html
