rules:
  - id: go.sql-injection.query
    patterns:
      - pattern: |
          $DB.Query($QUERY, ...)
      - pattern-not: $DB.Query("...", ...)
    message: "Potential SQL injection - dynamic query construction"
    severity: ERROR
    languages: [go]
    metadata:
      category: security
      cwe: "CWE-89"
      owasp: "A03:2021 - Injection"
      confidence: HIGH
      references:
        - https://cwe.mitre.org/data/definitions/89.html
