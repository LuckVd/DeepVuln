rules:
  - id: python.sql-injection.execute
    patterns:
      - pattern-either:
          - pattern: $CURSOR.execute($QUERY, ...)
          - pattern: $CONN.execute($QUERY, ...)
          - pattern: $DB.exec($QUERY, ...)
      - pattern-not: $CURSOR.execute("...", ...)
    message: "Potential SQL injection vulnerability - user input may be directly concatenated into SQL query"
    severity: ERROR
    languages: [python]
    metadata:
      category: security
      cwe: "CWE-89"
      owasp: "A03:2021 - Injection"
      confidence: HIGH
      references:
        - https://cwe.mitre.org/data/definitions/89.html
        - https://owasp.org/Top10/A03_2021-Injection/
